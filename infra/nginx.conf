server {
  listen 80;

  # (Optional but helpful if users upload images)
  client_max_body_size 20M;

  # API -> Django
  location /api/ {
    proxy_set_header Host $http_host;
    # proxy_set_header X-Forwarded-Proto $scheme;
    # proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_pass http://backend:8000/api/;
  }

  # Django Admin
  location /admin/ {
    proxy_set_header Host $http_host;
    # proxy_set_header X-Forwarded-Proto $scheme;
    # proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_pass http://backend:8000/admin/;
  }

  # Media files served by Nginx from a volume
  location /media/ {
    alias /media/;
    autoindex off;
    access_log off;
  }

  # SPA and collected static; index.html is the entry point
  location / {
    alias /static/;
    # index index.html;
    # root /static;
    try_files $uri /index.html;
    # If your SPA needs deep-link support (e.g., /recipes/123),
    # switch to the "root" variant below (see note).
    # try_files with alias is tricky, so we keep Kittygram's pattern.
  }
}

# server {
#     listen 80;
#     client_max_body_size 10M;

#     location /api/docs/ {
#         root /usr/share/nginx/html;
#         try_files $uri $uri/redoc.html;
#     }
    
#     location / {
#         root /usr/share/nginx/html;
#         index  index.html index.htm;
#         try_files $uri /index.html;
#       }

# }
